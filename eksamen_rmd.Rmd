---
title: "NFL Data"
author: "Team 2 (Patrick Berthelsen, Natascha Svarre, Alex Rye & Nino Krupic)"
date: "11/2/2021"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Always run this
```{r}
library(tidyverse)


pacman::p_load(
  ggplot2, #for plotting graphics
  ggmap, #for plotting maps
  RColorBrewer, #provide pretty colour palettes
  lubridate, #for converting time variables into date format
  hrbrthemes, #for more style themes
  data.table, #for working with data.table
  dplyr, #for count function
  tidytext, #for text mining functions such as unnest()
  wordcloud,
  tm, #for removing stopwords
  ggdist, #for raincloud plots
  tidyquant, #for theme_tq
  prismatic, #for color handling in plots
  gganimate, #for animated plots
  gifski #for rendering animated plots as GIFs instead of single frames
)


```


### Data cleaning
```{r}

standings <- read.csv("standings.csv")
standings$team <- NULL

head(standings)
str(standings) # Dispalys the structure of our data.





games <- read.csv("games.csv")
games$winners <- stringr::word(games$winner, -1)
games[ ,c('winner', 'home_team', 'away_team', 'day', 'date', 'time', 'home_team_city', 'away_team_city')] <- list(NULL)

head(games)
str(games)


```



### EDA 
```{r}


#Subset of SB-Winners
sb_winners <- standings[ which(standings$sb_winner=="Won Superbowl"), ]


#Barplot of wins in regular season by the SB-winner 2000-2019
sb_winners %>% 
  ggplot(aes(x = year, y = wins)) + 
  geom_line() +
  labs(title = "Regular season wins by SB-sinners 2000-2019", x = "Year", y = "Games won") +
  theme_linedraw() + 
  theme(plot.title = element_text(hjust = 0.5))

#Barplot of SB-wins per team
ggplot(data = sb_winners) + 
  geom_bar(aes(team_name)) + 
  theme_linedraw() + 
  labs(title = "Number of Superbowl won pr team", x = "Teams", y = "SB won") +
  theme(plot.title = element_text(hjust = 0.5))

#Barplot of total wins per team
ggplot(data = games) + 
  geom_bar(aes(winners)) + 
  theme_linedraw() + 
  labs(title = "Number of games won pr team", x = "Teams", y = "Games won") +
  theme(plot.title = element_text(hjust = 0.5)) + 
  coord_flip()

#Correlation between points and yards
games %>% 
    ggplot(aes(x = yds_win, y = pts_win)) + 
    geom_point()

games %>% 
    ggplot(aes(x = yds_loss, y = pts_loss)) + 
    geom_point()



```




### Wordcloud
```{r}
#Dataset of only winners of games

library(RColorBrewer)         
library(wordcloud)  

game_winners <- games["winners"] %>% 
  group_by(winners) %>% #grouping each word so that we can count number of times the word appears below
  mutate(total_wins = n()) %>% #counting number of times the word appears
  ungroup() %>% #ungrouping the words again
  count(winners, sort = TRUE)


wordcloud(words = game_winners$winners, freq = game_winners$n, min.freq = 0,
          max.words=200, random.order=FALSE, rot.per=0.3, 
          colors=brewer.pal(9, "GnBu")[3:9], scale=c(3,.5))
```



